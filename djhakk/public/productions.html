<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>プロダクション - DJHAKK</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    
    <style>
        /* Page-specific styles */
        .search-box { position: relative; margin-bottom: 16px; }
        .search-input { width: 100%; padding: 14px 16px 14px 44px; background: var(--card); border: 1px solid var(--border); border-radius: var(--r-lg); color: var(--text); font-size: 16px; }
        .search-input:focus { outline: none; border-color: var(--primary); }
        .search-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text3); }
        .filters { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-btn { padding: 8px 16px; background: var(--card); border: 1px solid var(--border); border-radius: 20px; color: var(--text2); font-size: 13px; cursor: pointer; }
        .filter-btn.active { background: var(--gradient); color: white; border-color: transparent; }
        
        /* Modal */
        .modal-img { width: 100%; aspect-ratio: 1; object-fit: cover; }
        .modal-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
        .modal-price { font-size: 28px; font-weight: 700; color: var(--primary); margin-bottom: 16px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="logo.png" class="header-logo" onclick="window.location.href='timeline.html'">
            <span class="header-title">PRODUCTION</span>
            <div id="headerProfileArea"></div>
        </div>
        <div class="search-box">
            <span class="search-icon"><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></span>
            <input type="text" class="search-input" placeholder="PRODUCTION SEARCH" id="searchInput" oninput="filterProductions()">
        </div>
        <div class="filters">
            <button class="filter-btn active" data-filter="all" onclick="setFilter('all')">ALL</button>
            <button class="filter-btn" data-filter="audio" onclick="setFilter('audio')">DOWNLOAD SALES</button>
            <button class="filter-btn" data-filter="goods" onclick="setFilter('goods')">ITEM SALES</button>
            <button class="filter-btn" data-filter="produce" onclick="setFilter('produce')">SELF PRODUCE</button>
        </div>
        <div id="productionsList"></div>
        
        <!-- Pagination UI -->
        <div id="loadingSpinner" class="loading-spinner" style="display:none;">
            <img src="logo.png" class="spinner-logo">
            <span>Loading...</span>
        </div>
        <button id="loadMoreBtn" class="load-more-btn" style="display:none;" onclick="loadMoreProductions()">もっと見る</button>
        <div id="noMoreData" class="no-more-data" style="display:none;"><img src="logo.png"></div>
    </div>
    
    <!-- Detail Modal -->
    <div class="modal" id="productionModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" onclick="closeModal()">← Back</button>
            </div>
            <img id="modalImg" class="modal-img" src="logo.png">
            <div class="modal-body">
                <span class="badge audio" id="modalBadge">DOWNLOAD SALES</span>
                <h1 class="modal-title" id="modalTitle"></h1>
                <p class="modal-price" id="modalPrice"></p>
                <div id="modalWaveform" style="margin-bottom: 20px;"></div>
                <div id="modalCreator" style="background: var(--card); border-radius: 12px; padding: 16px; margin-bottom: 20px;"></div>
                <div id="modalSns" style="margin-bottom: 16px;"></div>
                <p id="modalDesc" style="color: var(--text2); margin-bottom: 24px; white-space: pre-wrap; word-break: break-word;"></p>
                <button class="btn btn-p btn-lg" onclick="handlePurchase()">Buy</button>
            </div>
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <button class="fab" onclick="handleCreateClick()">+</button>
    
    <!-- Footer Navigation -->
    <nav class="nav">
        <div class="nav-item" onclick="window.location.href='index.html?tab=home'"><span>Home</span></div>
        <div class="nav-item" onclick="window.location.href='events.html'"><span>Event</span></div>
        <div class="nav-item" onclick="window.location.href='timeline.html'"><span>TimeLine</span></div>
        <div class="nav-item active"><span>Production</span></div>
        <div class="nav-item" onclick="window.location.href='place.html'"><span>Place</span></div>
    </nav>
    <div class="toast" id="toast"></div>
    
    <!-- Common JS -->
    <script src="js/config.js"></script>
    <script src="js/firebase-init.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/data.js"></script>
    <script src="js/interactions.js"></script>
    <script src="js/audio-player.js"></script>
    <script src="js/stripe.js"></script>
    
    <!-- Page-specific JS -->
    <script src="js/pages/productions.js"></script>
    <script src="js/lazy-load.js"></script>
</body>
</html>
