<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Place - DJHAKK</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>
    
    <style>
        /* Page-specific styles */
        .search-box { position: relative; margin-bottom: 16px; }
        .search-input { width: 100%; padding: 14px 16px 14px 44px; background: var(--card); border: 1px solid var(--border); border-radius: var(--r-lg); color: var(--text); font-size: 16px; }
        .search-input:focus { outline: none; border-color: var(--primary); }
        .search-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text3); }
        
        .filter-row { display: flex; gap: 8px; margin-bottom: 12px; align-items: center; }
        .filter-label { font-size: 12px; color: var(--text3); min-width: 40px; }
        .filters { display: flex; gap: 8px; flex-wrap: wrap; flex: 1; }
        .filter-btn { padding: 8px 16px; background: var(--card); border: 1px solid var(--border); border-radius: 20px; color: var(--text2); font-size: 13px; cursor: pointer; white-space: nowrap; }
        .filter-btn.active { background: var(--gradient); color: white; border-color: transparent; }
        
        /* Modal */
        .modal-img { width: 100%; aspect-ratio: 1; object-fit: cover; }
        .modal-title { font-size: 24px; font-weight: 700; margin-bottom: 16px; }
        .modal-info { display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px; }
        .modal-info-item { display: flex; align-items: flex-start; gap: 8px; color: var(--text2); word-break: break-word; }
        .modal-info-item a { color: var(--primary); text-decoration: none; word-break: break-all; }
        .modal-info-item a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="logo.png" class="header-logo" onclick="window.location.href='timeline.html'">
            <span class="header-title">PLACE</span>
            <div id="headerProfileArea"></div>
        </div>
        <div class="search-box">
            <span class="search-icon"><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></span>
            <input type="text" class="search-input" placeholder="PLACE SEARCH" id="searchInput" oninput="filterPlaces()">
        </div>
        
        <div class="filter-row">
            <span class="filter-label">Type</span>
            <div class="filters">
                <button class="filter-btn active" data-filter="all" onclick="setTypeFilter('all')">All</button>
                <button class="filter-btn" data-filter="place" onclick="setTypeFilter('place')">PLACE</button>
                <button class="filter-btn" data-filter="agency" onclick="setTypeFilter('agency')">AGENCY</button>
                <button class="filter-btn" data-filter="shop" onclick="setTypeFilter('shop')">SHOP</button>
            </div>
        </div>
        
        <div class="filter-row">
            <span class="filter-label">AREA</span>
            <select id="regionFilter" class="region-select" onchange="setRegionFilter()">
                <option value="all">ALL AREA</option>
                <optgroup label="JAPAN">
                    <option value="TOKYO">TOKYO</option>
                    <option value="OSAKA">OSAKA</option>
                    <option value="NAGOYA">NAGOYA</option>
                    <option value="FUKUOKA">FUKUOKA</option>
                    <option value="OKINAWA">OKINAWA</option>
                </optgroup>
                <optgroup label="ASIA">
                    <option value="SEOUL">SEOUL</option>
                    <option value="SHANGHAI">SHANGHAI</option>
                    <option value="HONG KONG">HONG KONG</option>
                    <option value="BANGKOK">BANGKOK</option>
                    <option value="SINGAPORE">SINGAPORE</option>
                </optgroup>
                <optgroup label="NORTH AMERICA">
                    <option value="NEW YORK">NEW YORK</option>
                    <option value="LOS ANGELES">LOS ANGELES</option>
                    <option value="MIAMI">MIAMI</option>
                    <option value="CHICAGO">CHICAGO</option>
                    <option value="LAS VEGAS">LAS VEGAS</option>
                </optgroup>
                <optgroup label="EUROPE">
                    <option value="BERLIN">BERLIN</option>
                    <option value="LONDON">LONDON</option>
                    <option value="AMSTERDAM">AMSTERDAM</option>
                    <option value="IBIZA">IBIZA</option>
                    <option value="PARIS">PARIS</option>
                    <option value="BARCELONA">BARCELONA</option>
                </optgroup>
            </select>
        </div>
        
        <div id="placesList"></div>
        
        <!-- Pagination UI -->
        <div id="loadingSpinner" class="loading-spinner" style="display:none;">
            <img src="logo.png" class="spinner-logo">
            <span>Loading...</span>
        </div>
        <button id="loadMoreBtn" class="load-more-btn" style="display:none;" onclick="loadMorePlacesData()">„ÇÇ„Å£„Å®Ë¶ã„Çã</button>
        <div id="noMoreData" class="no-more-data" style="display:none;"><img src="logo.png"></div>
    </div>
    
    <!-- Place Detail Modal -->
    <div class="modal" id="placeModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" onclick="closePlaceModal()">‚Üê Back</button>
            </div>
            <img id="modalImg" class="modal-img" src="logo.png">
            <div class="modal-body">
                <span class="badge place" id="modalBadge">PLACE</span>
                <h1 class="modal-title" id="modalTitle"></h1>
                <div class="modal-info">
                    <div class="modal-info-item" id="modalLocation">üìç </div>
                    <div class="modal-info-item" id="modalRegion">üåè </div>
                    <div class="modal-info-item" id="modalUrl">üîó </div>
                </div>
                <div id="modalCreator" style="background: var(--card); border-radius: 12px; padding: 16px; margin-top: 20px;"></div>
                <div id="modalSns" style="margin-top: 16px;"></div>
                <p id="modalDesc" style="color: var(--text2); margin-top: 20px; white-space: pre-wrap; word-break: break-word;"></p>
            </div>
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <button class="fab" onclick="handleCreateClick()">+</button>
    
    <!-- Footer Navigation -->
    <nav class="nav">
        <div class="nav-item" onclick="window.location.href='index.html?tab=home'"><span>Home</span></div>
        <div class="nav-item" onclick="window.location.href='events.html'"><span>Event</span></div>
        <div class="nav-item" onclick="window.location.href='timeline.html'"><span>TimeLine</span></div>
        <div class="nav-item" onclick="window.location.href='productions.html'"><span>Production</span></div>
        <div class="nav-item active"><span>Place</span></div>
    </nav>
    <div class="toast" id="toast"></div>
    
    <!-- Common JS -->
    <script defer src="js/config.js"></script>
    <script defer src="js/firebase-init.js"></script>
    <script defer src="js/ui.js"></script>
    <script defer src="js/auth.js"></script>
    <script defer src="js/data.js"></script>
    <script defer src="js/interactions.js"></script>
    
    <!-- Page-specific JS -->
    <script defer src="js/pages/place.js"></script>
    <script defer src="js/lazy-load.js"></script>
</body>
</html>
